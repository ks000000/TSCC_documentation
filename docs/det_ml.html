<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Machine learning error detection &mdash; TSCC 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Baseline error detection" href="det_baseline.html" />
    <link rel="prev" title="Statistical error detection" href="det_statistical.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            TSCC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api_reference.html">API-Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#exploration">Exploration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="api_reference.html#detection">Detection</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="det_basics.html">Observation reliability</a></li>
<li class="toctree-l3"><a class="reference internal" href="det_statistical.html">Statistical error detection</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Machine learning error detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="det_baseline.html">Baseline error detection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#correction">Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html#assessment">Assessment</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TSCC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api_reference.html">API-Reference</a></li>
      <li class="breadcrumb-item active">Machine learning error detection</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-TSCC.detection.ml">
<span id="machine-learning-error-detection"></span><h1>Machine learning error detection<a class="headerlink" href="#module-TSCC.detection.ml" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byIsolationForest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TSCC.detection.ml.</span></span><span class="sig-name descname"><span class="pre">ML_byIsolationForest</span></span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byIsolationForest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byIsolationForest" title="Permalink to this definition"></a></dt>
<dd><p>A class that encapsulates the functionality of an Isolation Forest model for detecting anomalies and provides
methods for fitting the model, predicting outliers, and saving/loading the trained model.</p>
<p>The class is designed for unsupervised anomaly detection in time series or tabular data and leverages the
Isolation Forest algorithm, which isolates anomalies by partitioning data points in a random forest structure.
It supports configurations for model parameters like the number of estimators and contamination rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_estimators</strong><span class="classifier">int, default=100</span></dt><dd><p>The number of base estimators (trees) in the Isolation Forest ensemble.</p>
</dd>
<dt><strong>max_samples</strong><span class="classifier">int, float, or ‘auto’, default=’auto’</span></dt><dd><p>The number of samples to draw from the input data to train each base estimator.</p>
</dd>
<dt><strong>contamination</strong><span class="classifier">‘auto’ or float, default=’auto’</span></dt><dd><p>The proportion of outliers in the dataset. If ‘auto’, the contamination is inferred.</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">int, RandomState instance, or None, default=None</span></dt><dd><p>Controls the randomness of the algorithm for reproducibility.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model</strong><span class="classifier">IsolationForest</span></dt><dd><p>The underlying Isolation Forest model used for anomaly detection.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>fit(df_fea, df_tar, config)</strong></p></td>
<td><p>Fits the Isolation Forest model to the provided feature data.</p></td>
</tr>
<tr class="row-even"><td><p><strong>predict(df_fea)</strong></p></td>
<td><p>Predicts whether each observation in the input dataframe is an anomaly.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>save_model(path)</strong></p></td>
<td><p>Saves the trained Isolation Forest model to a specified file path.</p></td>
</tr>
<tr class="row-even"><td><p><strong>load_model(path)</strong></p></td>
<td><p>Loads a previously saved Isolation Forest model from a file.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byIsolationForest.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contamination</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byIsolationForest.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byIsolationForest.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the IsolationForest model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byIsolationForest.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_tar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byIsolationForest.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byIsolationForest.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the Isolation Forest model to the input feature data.</p>
<p>This method trains the Isolation Forest model on the provided dataset, identifying patterns in the normal data points and learning how to detect anomalies. It requires that the input data contains no NaN values, as the model cannot handle missing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_fea</strong><span class="classifier">pandas DataFrame or pandas Series</span></dt><dd><p>The feature data on which to train the model. This data should not contain any missing values (NaN).</p>
</dd>
<dt><strong>df_tar</strong><span class="classifier">pandas DataFrame or pandas Series, optional</span></dt><dd><p>The target data (if any) is not used in unsupervised anomaly detection but can be passed for consistency in the API. Default is None.</p>
</dd>
<dt><strong>config</strong><span class="classifier">object, optional</span></dt><dd><p>Configuration object (if any) is not used in unsupervised anomaly detection but can be passed for consistency in the API. Default is None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>This method fits the Isolation Forest model and updates the model’s internal state.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byIsolationForest.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byIsolationForest.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byIsolationForest.load_model" title="Permalink to this definition"></a></dt>
<dd><p>Load the model from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to the model file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byIsolationForest.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byIsolationForest.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byIsolationForest.predict" title="Permalink to this definition"></a></dt>
<dd><p>Predict values based on the Isolation Forest model to the provided dataframe.
Function does not support NaN values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_fea</strong><span class="classifier">pandas dataframe or pandas series</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hasGoodDQ</strong><span class="classifier">pandas series</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byIsolationForest.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byIsolationForest.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byIsolationForest.save_model" title="Permalink to this definition"></a></dt>
<dd><p>Save the model to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to save the model file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byMLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TSCC.detection.ml.</span></span><span class="sig-name descname"><span class="pre">ML_byMLP</span></span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byMLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byMLP" title="Permalink to this definition"></a></dt>
<dd><p>A class for building and using a Multi-Layer Perceptron (MLP) classifier for supervised machine learning tasks.</p>
<p>This class utilizes the <cite>MLPClassifier</cite> from the scikit-learn library to model data using a feedforward neural network.
The architecture of the network, including the number of hidden layers and the activation function, can be customized through the constructor parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>hidden_layer_sizes</strong><span class="classifier">tuple, optional, default=(100,)</span></dt><dd><p>Defines the number of neurons in each hidden layer. The length of the tuple indicates the number of hidden layers.</p>
</dd>
<dt><strong>activation</strong><span class="classifier">{‘identity’, ‘logistic’, ‘tanh’, ‘relu’}, optional, default=’relu’</span></dt><dd><p>The activation function for the hidden layer.</p>
</dd>
<dt><strong>solver</strong><span class="classifier">{‘lbfgs’, ‘sgd’, ‘adam’}, optional, default=’adam’</span></dt><dd><p>The algorithm used for weight optimization.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float, optional, default=0.0001</span></dt><dd><p>L2 regularization term to prevent overfitting.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier">int or ‘auto’, optional, default=’auto’</span></dt><dd><p>The size of minibatches for stochastic optimizers.</p>
</dd>
<dt><strong>learning_rate</strong><span class="classifier">{‘constant’, ‘invscaling’, ‘adaptive’}, optional, default=’constant’</span></dt><dd><p>The learning rate schedule for weight updates.</p>
</dd>
<dt><strong>learning_rate_init</strong><span class="classifier">float, optional, default=0.001</span></dt><dd><p>The initial learning rate.</p>
</dd>
<dt><strong>max_iter</strong><span class="classifier">int, optional, default=200</span></dt><dd><p>The maximum number of iterations for training.</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">int, RandomState instance or None, optional, default=None</span></dt><dd><p>Controls the random seed for reproducibility.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>fit(df_fea, df_tar, config):</strong></p></td>
<td><p>Trains the MLP model on the provided feature data and target labels.</p></td>
</tr>
<tr class="row-even"><td><p><strong>predict(df_fea):</strong></p></td>
<td><p>Predicts class labels for new input samples based on the trained model.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>save_model(path):</strong></p></td>
<td><p>Saves the trained model to a specified file path.</p></td>
</tr>
<tr class="row-even"><td><p><strong>load_model(path):</strong></p></td>
<td><p>Loads a trained model from a specified file path.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byMLP.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(100,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byMLP.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byMLP.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the MLPClassifier model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byMLP.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_tar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byMLP.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byMLP.fit" title="Permalink to this definition"></a></dt>
<dd><p>Trains the Multi-Layer Perceptron (MLP) classifier using the provided feature data and target labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_fea</strong><span class="classifier">pandas DataFrame</span></dt><dd><p>The input feature data used for training the model, where each row represents a sample and each column represents a feature.</p>
</dd>
<dt><strong>df_tar</strong><span class="classifier">pandas Series or array-like</span></dt><dd><p>The target labels corresponding to the input feature data. Each value indicates the class label for the respective sample.</p>
</dd>
<dt><strong>config</strong><span class="classifier">object, optional</span></dt><dd><p>Configuration object for any additional settings (not currently used in this method).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byMLP.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byMLP.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byMLP.load_model" title="Permalink to this definition"></a></dt>
<dd><p>Load the model from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to the model file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byMLP.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byMLP.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byMLP.predict" title="Permalink to this definition"></a></dt>
<dd><p>Predicts class labels for the given input feature data using the trained MLP classifier.</p>
<p>This method uses the fitted MLP model in a class instance to generate predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_fea</strong><span class="classifier">pandas DataFrame</span></dt><dd><p>The input feature data for which predictions are to be made. Each row should represent a sample, and each column should represent a feature.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas Series</dt><dd><p>A Series containing the predicted class labels for each input sample. The values are cast to float for compatibility with other numerical operations.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byMLP.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byMLP.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byMLP.save_model" title="Permalink to this definition"></a></dt>
<dd><p>Save the model to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to save the model file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byOneClassSVM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TSCC.detection.ml.</span></span><span class="sig-name descname"><span class="pre">ML_byOneClassSVM</span></span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byOneClassSVM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byOneClassSVM" title="Permalink to this definition"></a></dt>
<dd><p>A class that encapsulates the functionality of a OneClassSVM model for anomaly detection and provides methods for
reducing training samples, fitting the model, and making predictions.</p>
<p>The class is designed to handle large datasets and includes functionality for reducing the number of training
samples by undersampling based on conditions such as sensor type and the distribution of target values.
It uses a OneClassSVM model to detect anomalies in time series data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>threshold_nrObs</strong><span class="classifier">int, default=10000</span></dt><dd><p>The maximum number of observations to be used for training. If the dataset exceeds this threshold, undersampling or random sampling is applied.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model</strong><span class="classifier">OneClassSVM</span></dt><dd><p>The OneClassSVM model used for anomaly detection.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>reduce_training_samples(df_fea, gt_series_num, config)</strong></p></td>
<td><p>Reduces the number of training samples based on ground truth values, sensor type, and predefined thresholds.</p></td>
</tr>
<tr class="row-even"><td><p><strong>fit(df_fea, df_tar, config)</strong></p></td>
<td><p>Fits the OneClassSVM model to the input features.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>predict(df_fea)</strong></p></td>
<td><p>Predicts whether each observation in the input dataframe is an anomaly.</p></td>
</tr>
<tr class="row-even"><td><p><strong>save_model(path)</strong></p></td>
<td><p>Saves the trained OneClassSVM model to a specified path.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>load_model(path)</strong></p></td>
<td><p>Loads a previously saved OneClassSVM model from a file.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byOneClassSVM.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold_nrObs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byOneClassSVM.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byOneClassSVM.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the ML_byOneClassSVM class with a default threshold for the number of observations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byOneClassSVM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_tar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byOneClassSVM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byOneClassSVM.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the OneClassSVM model to the provided dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_fea</strong><span class="classifier">pandas dataframe</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byOneClassSVM.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byOneClassSVM.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byOneClassSVM.load_model" title="Permalink to this definition"></a></dt>
<dd><p>Load the model from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to the model file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byOneClassSVM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byOneClassSVM.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byOneClassSVM.predict" title="Permalink to this definition"></a></dt>
<dd><p>Predict values based on the OneClassSVM model to the provided dataframe.
Function does not support NaN values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas dataframe</span></dt><dd></dd>
<dt><strong>oneClass_SVM</strong><span class="classifier">OneClassSVM object</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hasGoodDQ</strong><span class="classifier">pandas series</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byOneClassSVM.reduce_training_samples">
<span class="sig-name descname"><span class="pre">reduce_training_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_series_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byOneClassSVM.reduce_training_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byOneClassSVM.reduce_training_samples" title="Permalink to this definition"></a></dt>
<dd><p>Reduces the number of training samples in the dataframe based on specific conditions and performs undersampling.</p>
<p>This function performs undersampling on the input dataframe based on the target values (<cite>gt_series_num</cite>) and sensor type
specified in the <cite>config</cite>. The function supports precipitation-type data by undersampling within specified ranges of
ground truth values and target detection. The number of samples is reduced to match a predefined threshold.</p>
<p>If the size of the filtered dataframe still exceeds the threshold, the function reduces it further by random sampling
or concatenating a small subset of the original dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_fea</strong><span class="classifier">pandas DataFrame</span></dt><dd><p>The input features for training.</p>
</dd>
<dt><strong>gt_series_num</strong><span class="classifier">pandas Series or ndarray</span></dt><dd><p>The target ground truth values (used for filtering).</p>
</dd>
<dt><strong>config</strong><span class="classifier">object</span></dt><dd><p>Configuration object that includes sensor type and column names.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>df_filtered</strong><span class="classifier">pandas DataFrame</span></dt><dd><p>The dataframe with reduced samples, after applying undersampling based on conditions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byOneClassSVM.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byOneClassSVM.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byOneClassSVM.save_model" title="Permalink to this definition"></a></dt>
<dd><p>Save the model to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to save the model file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byRF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TSCC.detection.ml.</span></span><span class="sig-name descname"><span class="pre">ML_byRF</span></span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byRF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byRF" title="Permalink to this definition"></a></dt>
<dd><p>A class for implementing a Random Forest Classifier for classification tasks.</p>
<p>This class utilizes the <cite>RandomForestClassifier</cite> from the scikit-learn library to model the relationship
between input features and target class labels. It provides methods for training the model, making predictions,
and saving/loading the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_estimators: int, optional, default=100</strong></dt><dd><p>The number of trees in the forest. A higher number can improve performance but increases computation time.</p>
</dd>
<dt><strong>random_state: int, RandomState instance or None, optional, default=None</strong></dt><dd><p>Controls the randomness of the estimator for reproducibility.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>fit(df_fea, df_tar, config):</strong></p></td>
<td><p>Fits the RandomForestClassifier model to the training data.</p></td>
</tr>
<tr class="row-even"><td><p><strong>predict(df_fea):</strong></p></td>
<td><p>Predicts class labels for the given input feature data.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>save_model(path):</strong></p></td>
<td><p>Saves the trained model to a specified file path.</p></td>
</tr>
<tr class="row-even"><td><p><strong>load_model(path):</strong></p></td>
<td><p>Loads a previously saved model from a specified file path.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byRF.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byRF.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byRF.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the ML_byRF class with a RandomForestClassifier model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byRF.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_tar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byRF.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byRF.fit" title="Permalink to this definition"></a></dt>
<dd><p>Trains the RandomForestClassifier model using the provided feature and target data.</p>
<p>This method fits the Random Forest model to the training dataset, enabling it to learn the relationship
between the input features and their corresponding target class labels. Note that the function does not
handle NaN values, so the input data must be preprocessed to ensure it is free of missing values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_fea: pandas DataFrame</strong></dt><dd><p>A DataFrame containing the input features for training. Each column represents a feature, and each row
represents a training sample.</p>
</dd>
<dt><strong>df_tar: pandas DataFrame or Series</strong></dt><dd><p>The target values (class labels) corresponding to the input features. This should be a one-dimensional
array-like structure where each entry matches the class label for the respective training sample in <cite>df_fea</cite>.</p>
</dd>
<dt><strong>config: optional</strong></dt><dd><p>A configuration object that can be used to specify additional parameters for model fitting, although it
is not utilized in this method.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>The fitted model is stored within the instance, allowing for subsequent predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byRF.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byRF.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byRF.load_model" title="Permalink to this definition"></a></dt>
<dd><p>Load the model from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to the model file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byRF.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_fea</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byRF.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byRF.predict" title="Permalink to this definition"></a></dt>
<dd><p>Predicts the class labels for the given input samples using the trained RandomForestClassifier model.</p>
<p>This method takes a DataFrame of input features and uses the fitted model to generate predictions for each
sample. The predictions indicate whether each sample is classified as an outlier or not. The method does not
support NaN values, so ensure that the input data is clean before calling this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_fea: pandas DataFrame</strong></dt><dd><p>A DataFrame containing the input features for which predictions are to be made. Each column represents a
feature, and each row corresponds to a sample.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas Series</dt><dd><p>A Series containing the predicted class labels for each input sample, with the same index as
the input DataFrame. The values are converted to floats for consistency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TSCC.detection.ml.ML_byRF.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TSCC/detection/ml.html#ML_byRF.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TSCC.detection.ml.ML_byRF.save_model" title="Permalink to this definition"></a></dt>
<dd><p>Save the model to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>The path to save the model file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="det_statistical.html" class="btn btn-neutral float-left" title="Statistical error detection" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="det_baseline.html" class="btn btn-neutral float-right" title="Baseline error detection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, default.
      <span class="lastupdated">Last updated on Sep 27, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>